
<div class="d-flex justify-content-between align-items-center mb-3">
  <h5>Adverse Events</h5>
  <a routerLink="/data-capture/adverse-events/new" class="btn btn-success">
    Report
  </a>
</div>

<!-- Filters -->
<div class="row g-3 mb-3">
  <div class="col-md-3">
    <label class="form-label">Severity</label>
    <select [(ngModel)]="severityFilter" class="form-select" (change)="load()">
      <option value="">All Severities</option>
      <option value="MILD">Mild</option>
      <option value="MODERATE">Moderate</option>
      <option value="SEVERE">Severe</option>
      <option value="CRITICAL">Critical</option>
    </select>
  </div>
</div>

<!-- Loading indicator -->
<div *ngIf="loading" class="text-center my-4">
  <div class="spinner-border" role="status"></div>
</div>

<!-- Events table -->
<table class="table table-hover" *ngIf="eventsFiltered.length && !loading">
  <thead>
    <tr>
      <th>ID</th>
      <th>Participant</th>
      <th>Severity</th>
      <th>Reported Date</th>
      <th>Description</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let ev of eventsFiltered">
      <td>{{ ev.eventId }}</td>
      <td>{{ ev.participantId }}</td>
      <td>
        <span class="badge"
              [class.bg-success]="ev.severity === 'MILD'"
              [class.bg-warning]="ev.severity === 'MODERATE'"
              [class.bg-danger]="ev.severity === 'SEVERE'"
              [class.bg-dark]="ev.severity === 'CRITICAL'">
          {{ ev.severity }}
        </span>
      </td>
      <!-- If you import DatePipe later, use: {{ ev.reportedDate | date }} -->
      <td>{{ ev.reportedDate }}</td>
      <td class="text-truncate" style="max-width: 320px">{{ ev.description }}</td>
      <td>
        <a [routerLink]="['/data-capture/adverse-events', ev.eventId]"
           class="btn btn-sm btn-outline-secondary">
          View
        </a>
      </td>
    </tr>
  </tbody>
</table>

<!-- Empty state -->
<div *ngIf="!eventsFiltered.length && !loading" class="text-muted">
  No events
</div>
